<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
    <link rel="icon" type="image/ico" href="/static/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>{{ data.pretty_name }} Â· GoDeep by DeepSight AI Labs</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport'/>
    <!-- Fonts and icons -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link href="/static/fontawesome/css/all.css" rel="stylesheet" />
    <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet" type='text/css' />
    <!-- CSS Files -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/static/css/main.css" rel="stylesheet" />
    <script src="/static/js/jquery.3.2.1.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        function allowEdit(option) {
            var div_name = "#".concat(option);
            $(div_name).removeAttr('readonly');
         }

        function passwordModal(){
            $("#newPassword").value = "";
            $("#confirmNewPassword").value = "";
            $("#oldPassword").value = "";
            var newPassword = document.getElementById("newPassword");
            var confirmNewPassword = document.getElementById("confirmNewPassword");
            var updatePassword = document.getElementById("updatePassword");
            confirmNewPassword.onkeyup = function() {
                if(confirmNewPassword.value == newPassword.value){
                    $("#updatePassword").removeAttr('disabled');
                }
                else{
                    $("#updatePassword").prop('disabled', true);
                }
            }
        }

        function fromEmailModal(){
            $("#fromEmailPassword").value = "";
            $("#confirmFromEmailPassword").value = "";
            var fromEmailPassword = document.getElementById("fromEmailPassword");
            var comfirmFromEmailPassword = document.getElementById("comfirmFromEmailPassword");
            var updateFromEmail = document.getElementById("updateFromEmail");
            var fromEmail = document.getElementById("fromEmail");
            confirmFromEmailPassword.onkeyup = function() {
                if(confirmFromEmailPassword.value == fromEmailPassword.value){
                    $("#updateFromEmail").removeAttr('disabled');
                    $("#verifyFromEmail").removeAttr('disabled');
                }
                else{
                    $("#updateFromEmail").prop('disabled', true);
                    $("#verifyFromEmail").prop('disabled', true);
                }
            }
        }



        function updatePasswordFunction(){
            var username = document.getElementById('username');
            var newPassword = document.getElementById("newPassword");
            var oldPassword = document.getElementById("oldPassword");
            var request_data = {"username": username.value, "password": oldPassword.value, "new_password": newPassword.value};
            $.ajax({
                type: "POST",
                url: "/updatePassword",
                contentType: "application/json",
                data: JSON.stringify(request_data),
                dataType: "json",
                success: function(response) {
                    console.log(response);
                    window.alert(response.message)
                },
                error: function(err) {
                    console.log(err);
                }
            });
        }

        function updateFromEmailFunction(){
            var email = document.getElementById('fromEmail');
            var password = document.getElementById("fromEmailPassword");
            var recipientsList = document.getElementById("approvedRecipientsList");
            if (email.value == "" || password.value == "" || recipientsList.value == ""){
                window.alert("Invalid Input");
                return;
            }
            var request_data = {"email": email.value, "password": password.value, "recipients_list": recipientsList.value};
            $.ajax({
                type: "POST",
                url: "/updateFromEmail",
                contentType: "application/json",
                data: JSON.stringify(request_data),
                dataType: "json",
                success: function(response) {
                    console.log(response);
                    if (response.success){
                        console.log("success");
                    }
                    else{
                        console.log("failed");

                    }
                    window.alert(response.message);
                },
                error: function(err) {
                    console.log(err);
                }
            });
        }


    </script>

    <style>
    .btn {
        font-size:1em;
    }

    /*for the form placeholders*/
    ::placeholder {
        color: black !important;
        opacity: 1 !important; /* Firefox */
        font-size: 15px; !important
    }

    /*the tab pills' behavior*/
    .pill .active a{
        background:orange !important;
            color:white;
    }
    .pill .active a:hover{
            <!--background:orange !important;-->
        }
    .pill a:hover {
         background:orange !important;
        color:white;
    }
    .pill a:inactive {
        background:orange !important;
        color:white;

    }

    /*for the user text input*/
    input[type=text] {
        font-size: 15px;
    }

    /*for the text in the nav pills*/
    .nav-pill-text{
        font-size: 18px;
        font-weight: bold !important;
    }

    /*top bar button font size*/
    .top-bar-link p{
        font-size: 30px;
        color: black;
    }

    /*top bar button icon size*/
    .top-bar-link i{
        font-size: 30px !important;
        width: 40px !important;
        color: black;
    }

    html, body {
        height: 100%;
    }

    #wrap {
        min-height: 100%;
        /*background-size: cover;
        background-repeat: no-repeat;*/
        background-position: center center;
        margin-top: 100px;
        background-image: url('/static/img/wall.png')
    }

    .selected {
        background-color: #ebebeb;

    }

    .radio-label-text {
        padding: 5px;
    }

    #field {
    margin-bottom:20px;
    }

    .modal-backdrop {
        z-index: 100000 !important;
    }

    .modal {
        z-index: 100001 !important;
    }
    </style>
</head>

<body class="signup-page">
    <nav class="navbar navbar-expand-sm fixed-top bg-white">
        <div class="navbar-translate" style="height: 80px;">
                <a class="navbar-brand" href="http://www.deepsightlabs.com" target="_blank" rel="tooltip" title="DeepSight AI Labs" data-placement="bottom">
                    <img class="dsal_logo" src="/static/img/dsal.png">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-bar bar1"></span>
                    <span class="navbar-toggler-bar bar2"></span>
                    <span class="navbar-toggler-bar bar3"></span>
                </button>
        </div>
        <div class="container">
            <div class="navbar-collapse collapse" data-nav-image="/static/img/blur1.jpg" data-color="orange">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link top-bar-link" href="/list">
                            <i class="fa fa-list"></i>
                            <p>Home</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link top-bar-link" href="/view">
                            <i class="fa fa-camera"></i>
                            <p>View</p>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link top-bar-link" href="/add">
                            <i class="fa fa-plus"></i>
                            <p>Add Camera</p>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link top-bar-link" href="/user">
                            <i class="fa fa-users"></i>
                            <p>User</p>
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/home">
                            <i class="fa fa-file-alt"></i>
                            <p>License Status</p>
                        </a>
                    </li>
                    <!--<li class="nav-item dropdown">-->
                        <!--<a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown">-->
                            <!--<p>Background</p>-->
                        <!--</a>-->
                        <!--<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">-->
                            <!--<a class="dropdown-item" href="/background/bank/add_camera">Bank</a>-->
                            <!--<a class="dropdown-item" href="/background/hospital/add_camera">Hospital</a>-->
                            <!--<a class="dropdown-item" href="/background/insurance/add_camera">Insurance</a>-->
                            <!--<a class="dropdown-item" href="/background/pixel/add_camera">Pixel</a>-->
                            <!--<a class="dropdown-item" href="/background/retail/add_camera">Retail</a>-->
                        <!--</div>-->
                    <!--</li>-->
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <form class="form" action="/logout">
                            <button class="btn btn-warning btn-icon btn-round" title="Logout">
                                <i class="fa fa-sign-out"></i>
                            </button>
                        </form>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="wrapper" id="wrap">
        <!--<div class="page-header section-image">-->
            <!--<div class="page-header-image" style="background-image: url('/static/img/{{ image }}');"></div>-->
            <div class="content">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12 ml-auto mr-auto">
                            <div class="card card-signup" style="padding-bottom:80px;">
                                <div class="card-body">
                                    {% block content %}
                                        <div class="container">
                                            {% with messages = get_flashed_messages() %}
                                                {% if messages %}
                                                    {% for message in messages %}
                                                    <div class="alert alert-warning">
                                                        <button type="button" class="close" data-dismiss="alert">&times;</button>
                                                        <font color="black">{{ message }}</font>
                                                    </div>
                                                    {% endfor %}
                                                {% endif %}
                                            {% endwith %}
                                        </div>
                                        {% endblock %}
                                    {% if data.pretty_name %}
                                    <h3 class="card-title text-center"><b>Welcome, {{ data.pretty_name }}!</b></h3>
                                    {% else %}
                                    <h3 class="card-title text-center"><b>Welcome, New User!</b></h3>
                                    {% endif %}
                                    <br>
                                    <form class="form" method="POST" action="/updateUser">
                                        <div id="changePasswordModal" class="modal fade" role="dialog">
                                                <div class="modal-dialog modal-lg">
                                                <!-- Modal content-->
                                                    <div class="modal-content">
                                                        <div class="modal-body">
                                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="oldPassword" name="oldPassword" type="password" class="form-control" placeholder="Current Password">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="newPassword" name="newPassword" type="password" class="form-control" placeholder="New Password">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="confirmNewPassword" name="confirmNewPassword" type="password" class="form-control" placeholder="Confirm New Password">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-2 form-group">
                                                                        <button id="updatePassword" type="button" class="btn btn-info btn-round" onclick="updatePasswordFunction()" disabled>Submit</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        <div id="changeFromEmailModal" class="modal fade" role="dialog">
                                                <div class="modal-dialog modal-lg">
                                                <!-- Modal content-->
                                                    <div class="modal-content">
                                                        <div class="modal-body">
                                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="fromEmail" name="fromEmail" type="email" class="form-control" placeholder="Sender Email Address" >
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="fromEmailPassword" name="fromEmailPassword" type="password" class="form-control" placeholder="Sender Email Password">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="confirmFromEmailPassword" name="confirmFromEmailPassword" type="password" class="form-control" placeholder="Confirm Sender Email Password">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12 form-group">
                                                                        <input id="approvedRecipientsList" name="approvedRecipientsList" type="text" class="form-control" placeholder="List of Approved Recipients" pattern="^(\s?[^\s,]+@[^\s,]+\.[^\s,]+\s?,)*(\s?[^\s,]+@[^\s,]+\.[^\s,]+)$">
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-2 form-group">
                                                                        <button id="updateFromEmail" type="button" class="btn btn-info btn-round" onclick="updateFromEmailFunction()" disabled>Submit</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-12 form-group">
                                                    <input value="{{ data.username }}" id="username" name="username" type="text" class="form-control" placeholder="Username" required readonly>
                                                </div>
                                            </div>
                                            <div class="row">
                                                {% if not data.password %}
                                                <div class="col-md-11 form-group">
                                                    <input id="password" name="password" type="password" class="form-control" placeholder="Create New Password" required>
                                                </div>
                                                {% endif %}
                                            </div>
                                            <div class="row">
                                                {% if data.pretty_name %}
                                                <div class="col-md-11 form-group">
                                                    <input value="{{ data.pretty_name }}" id="pretty_name" name="pretty_name" type="text" class="form-control" placeholder="Name" required readonly>
                                                </div>
                                                <div class="col-md-1 form-group">
                                                     <a class="btn btn-default btn-icon btn-sm" data-original-title="Edit" title="Edit" onclick="allowEdit('pretty_name')">
                                                        <i class="fa fa-pencil"></i>
                                                     </a>
                                                </div>
                                                {% else %}
                                                <div class="col-md-11 form-group">
                                                    <input id="pretty_name" name="pretty_name" type="text" class="form-control" placeholder="Name" required>
                                                </div>
                                                {% endif %}
                                            </div>
                                            <div class="row">
                                                {% if data.email_address %}
                                                <div class="col-md-11 form-group">
                                                    <input value="{{ data.email_address }}" id="email_address" name="email_address" type="text" class="form-control" placeholder="Email" required readonly>
                                                </div>
                                                <div class="col-md-1 form-group">
                                                     <a class="btn btn-default btn-icon btn-sm" data-original-title="Edit" title="Edit" onclick="allowEdit('email')">
                                                        <i class="fa fa-pencil"></i>
                                                     </a>
                                                </div>
                                                {% else %}
                                                <div class="col-md-11 form-group">
                                                    <input id="email_address" name="email_address" type="text" class="form-control" placeholder="Email" required>
                                                </div>
                                                {% endif %}
                                            </div>
                                            <div class="row">
                                                {% if data.phone_number %}
                                                <div class="col-md-11 form-group">
                                                    <input value="{{ data.phone_number }}" id="phone_number" name="phone_number" type="text" class="form-control" placeholder="Phone Number" required readonly>
                                                </div>
                                                <div class="col-md-1 form-group">
                                                     <a class="btn btn-default btn-icon btn-sm" data-original-title="Edit" title="Edit" onclick="allowEdit('phone_number')">
                                                        <i class="fa fa-pencil"></i>
                                                     </a>
                                                </div>
                                                {% else %}
                                                <div class="col-md-11 form-group">
                                                    <input id="phone_number" name="phone_number" type="text" class="form-control" placeholder="Phone Number" required>
                                                </div>
                                                {% endif %}
                                            </div>
                                            {% if data.role %}
                                            <div class = "col-md-12 form-group">
                                                <label class="radio-inline radio-label-text">
                                                    <b>Role:</b>
                                                </label>
                                                <label class="radio-inline radio-label-text">
                                                    <input type="radio" name="user_role" id="user_role_admin" value=admin {{ 'checked' if data.role == "admin" }}>
<!--                                                                        here value 0 indicates low sensitivity-->
                                                    Admin
                                                </label>
                                                <label class="radio-inline radio-label-text">
                                                    <input type="radio" name="user_role" id="user_role_guest" value=guest {{ 'checked' if data.role == "guest" }} disabled>
<!--                                                                        here value 1 indicates normal sensitivity-->

                                                    User
                                                </label>
                                            </div>
                                            {% else %}
                                            <div class = "col-md-12 form-group">
                                                <label class="radio-inline radio-label-text">
                                                    <b>Role:</b>
                                                </label>
                                                <label class="radio-inline radio-label-text">
                                                    <input type="radio" name="user_role" id="user_role_admin" value=admin checked>
<!--                                                                        here value 0 indicates low sensitivity-->
                                                    Admin
                                                </label>
                                                <label class="radio-inline radio-label-text">
                                                    <input type="radio" name="user_role" id="user_role_guest" value=guest disabled>
<!--                                                                        here value 1 indicates normal sensitivity-->

                                                    User
                                                </label>
                                            </div>
                                            {% endif %}

                                            <div class="form-check" style="display:none;">
                                                <label class="form-check-label">
                                                    <input id="use_custom_from_email" name="use_custom_from_email" class="form-check-input" type="checkbox" {{ 'checked' if data.use_custom_from_email }}>
                                                    <span class="form-check-sign"></span>
                                                    Override Sender Email
                                                </label>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-2 form-group">
                                                    <button id="changePassword" type="button" class="btn btn-info btn-round" data-toggle="modal" data-target="#changePasswordModal" onclick="passwordModal()">Change Password</button>
                                                </div>
                                                <div class="col-md-2 form-group">
                                                    <button id="changeFromEmail" type="button" class="btn btn-info btn-round" data-toggle="modal" data-target="#changeFromEmailModal" onclick="fromEmailModal()">Change Sender Email</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center">
                                            <a href="/list" class="btn btn-round btn-default">Cancel</a>
                                            <button type="submit" class="btn btn-round btn-success">Done</button>
                                        </div>


                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <!--</div>-->
    </div>
    <footer class="footer">
        <div class="container">
            <nav>
                <ul>
                    <li>
                        <strong>GoDeep</strong> Platform
                    </li>
                </ul>
            </nav>
            <div class="copyright">
                &copy;
                <script>
                    document.write(new Date().getFullYear())
                </script>,
                <a href="http://www.deepsightlabs.com" target="_blank">DeepSight AI Labs</a>
            </div>
        </div>
    </footer>
</body>
<!-- Core JS Files -->
<script src="/static/js/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="/static/js/popper.min.js" type="text/javascript"></script>
<script src="/static/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/static/js/bootstrap-selectpicker.js" type="text/javascript"></script>
<script src="/static/js/jasny-bootstrap.min.js"></script>
<script src="/static/js/main.js"></script>
<script type="text/javascript" src="/static/js/jPolygon.js"></script>

</html>
